---
- name: Bootstrapping MariaDB
  command: kolla-kubernetes bootstrap mariadb

- name: Waiting for the MariaDB bootstrap to complete
  command: kubectl get jobs mariadb-bootstrap -o json
  register: result
  until: "{{ (result.stdout | from_json).status.succeeded }} == 1"
  retries: 4
  delay: 4
  ignore_errors: True

- fail: msg="Mariadb failed to bootstrap."
  when: "{{ (result.stdout | from_json).status.succeeded }} == 1"
