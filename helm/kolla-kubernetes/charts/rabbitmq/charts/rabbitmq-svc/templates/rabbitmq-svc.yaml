apiVersion: v1
kind: Service
spec:
  ports:
    - port: {{ .Values.global.rabbitmq_port }}
      name: rabbitmq
  selector:
    service: rabbitmq
metadata:
   name: rabbitmq
   namespace: {{ .Values.global.kolla_kubernetes_namespace }}
---
apiVersion: v1
kind: Service
spec:
  ports:
    - port: {{ .Values.global.rabbitmq_management_port }}
      name: management
{{- if .Values.global.rabbitmq_management_nodeport }}
      nodePort: {{ .Values.global.rabbitmq_management_nodeport }}
  type: NodePort
{{- else if  .Values.global.rabbitmq_management_external }}
  externalIPs:
    - {{ .Values.global.kolla_kubernetes_external_vip }}
{{- end }}
  selector:
    service: rabbitmq
metadata:
   name: rabbitmq-management
   namespace: {{ .Values.global.kolla_kubernetes_namespace }}
